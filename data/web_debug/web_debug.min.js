(function(f,k){function r(a,b,c){for(var d=!1,e=0;e<a.length;e++)if(a[e].attribute===b){d=e;break}!1===d?a.push({attribute:b,value:c}):a[d]={attribute:b,value:c};return a}function s(a,b){for(var c=f(a),d=!0,p=0;p<b.length;p++){var h=b[p];switch(h.attribute){case "__contains__":if(""===h.value)continue;else for(var h=h.value.toLowerCase().split(" "),g=c.find(".web-debug-log-message-holder").text().toLowerCase(),q=0;q<h.length;++q)-1===g.indexOf(h[q])&&(d=!1);break;default:g=c.data("log"+e.Util.ucFirst(h.attribute)),
"__all__"!==h.value&&g&&g!==h.value&&(d=!1)}}return d}var n={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(a){var b="",c,d,e,h,g,f,k=0;for(a=n._utf8_encode(a);k<a.length;)c=a.charCodeAt(k++),d=a.charCodeAt(k++),e=a.charCodeAt(k++),h=c>>2,c=(c&3)<<4|d>>4,g=(d&15)<<2|e>>6,f=e&63,isNaN(d)?g=f=64:isNaN(e)&&(f=64),b=b+this._keyStr.charAt(h)+this._keyStr.charAt(c)+this._keyStr.charAt(g)+this._keyStr.charAt(f);return b},decode:function(a){var b="",c,d,e,h,g,
f=0;for(a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");f<a.length;)c=this._keyStr.indexOf(a.charAt(f++)),d=this._keyStr.indexOf(a.charAt(f++)),h=this._keyStr.indexOf(a.charAt(f++)),g=this._keyStr.indexOf(a.charAt(f++)),c=c<<2|d>>4,d=(d&15)<<4|h>>2,e=(h&3)<<6|g,b+=String.fromCharCode(c),64!=h&&(b+=String.fromCharCode(d)),64!=g&&(b+=String.fromCharCode(e));return b=n._utf8_decode(b)},_utf8_encode:function(a){a=a.replace(/\r\n/g,"\n");for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);128>d?b+=String.fromCharCode(d):
(127<d&&2048>d?b+=String.fromCharCode(d>>6|192):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128)),b+=String.fromCharCode(d&63|128))}return b},_utf8_decode:function(a){for(var b="",c=0,d=c1=c2=0;c<a.length;)d=a.charCodeAt(c),128>d?(b+=String.fromCharCode(d),c++):191<d&&224>d?(c2=a.charCodeAt(c+1),b+=String.fromCharCode((d&31)<<6|c2&63),c+=2):(c2=a.charCodeAt(c+1),c3=a.charCodeAt(c+2),b+=String.fromCharCode((d&15)<<12|(c2&63)<<6|c3&63),c+=3);return b}},l=function(){return{set:function(a,
b,c,d,e,f){var g="";void 0!=c&&(g=new Date,g.setTime(g.getTime()+864E5*parseInt(c)),g="; expires="+g.toGMTString());void 0==d&&(d="/");void 0==e&&"undefined"!==typeof Config&&(e=Config.get("cookie_domain"));document.cookie=escape(a)+"="+escape(b||"")+g+(d?"; path="+d:"")+(e?"; domain="+e:"")+(f?"; secure":"")},get:function(a){a+="=";for(var b=document.cookie.split(";"),c=0;c<b.length;c++){for(var d=b[c];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return unescape(d.substring(a.length,
d.length))}return null},erase:function(a,b,c,d){try{var e=new Date;e.setTime(e.getTime()-36E5);var f="; expires="+e.toGMTString();document.cookie=escape(a)+"="+f+(b?"; path="+b:"")+(c?"; domain="+c:"")+(d?"; secure":"")}catch(g){return!1}return!0},remove:function(a,b,c,d){void 0==b&&(b="/");void 0==c&&"undefined"!==typeof Config&&(c=Config.get("cookie_domain"));return l.erase(a,b,c,d)},accept:function(){if("boolean"==typeof navigator.cookieEnabled)return navigator.cookieEnabled;l.set("_test","1");
return!0===l.erase("_test")}}}(),m=function(a){this.namespace=a||"";this.storageSupported="localStorage"in k&&null!==k.localStorage};m.prototype={constructor:m,isNativeStorageSupported:function(){return this.storageSupported},set:function(a,b){a+=this.namespace;this.isNativeStorageSupported()?k.localStorage.setItem(a,b):l.set(a,b)},get:function(a,b){a+=this.namespace;var c=this.isNativeStorageSupported()?k.localStorage.getItem(a):l.get(a);return"undefined"===typeof c||null===c?b:c},remove:function(a){a+=
this.namespace;this.isNativeStorageSupported()?k.localStorage.removeItem(a):l.remove(a)},clear:function(){return this.isNativeStorageSupported()?k.localStorage.clear():!1},isEmpty:function(){if(this.isNativeStorageSupported())return 0<k.localStorage.length},getNames:function(){if(!this.isNativeStorageSupported())return[];var a=[],b;for(b in k.localStorage)a.push(b);return a}};var t=function(){return{highlight:function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,
"&quot;").replace(/'/g,"&#039;")}}}(),e=function(a,b){this.options=f.extend(b||{},e.defaultOptions);a=n.decode(a);this.$element=f("#web-debug");this.$element.html(a);this.$toolbar=f("#web-debug-toolbar");this.$toolbarPanels=this.$toolbar.find("a");this.$toolbarTogglers=this.$toolbar.find("a.web-debug-toolbar-toggler");this.$panels=this.$element.find(".web-debug-panel");this.$status=this.$element.find("#web-debug-toolbar-status");e.Storage.get("closed")&&this.closeToolbar();this._setup();this._setupDataFilters();
this._setupTogglers();var c=this;f.each(e.Extensions,function(a,b){k.setTimeout(function(){b.setup(c)},0)})};e.prototype.closeToolbar=function(){this.$toolbar.addClass("closed");this.$panels.hide();this.$toolbarPanels.removeClass("active");this.$toolbar.find("ul > li").not("#web-debug-logo").not("#web-debug-toolbar-status").hide();this.$toolbar.trigger("closed")};e.prototype.openToolbar=function(){this.$toolbar.removeClass("closed");this.$toolbar.find("ul > li").not("#web-debug-logo").not("#web-debug-toolbar-status").show();
this.$toolbar.trigger("opened")};e.prototype.isToolbarClosed=function(){return this.$toolbar.hasClass("closed")};e.prototype.filter=[];e.defaultOptions={cookie:{name:"web_debug"},htmlValidator:{url:"http://html5.validator.nu/"}};e.STATUS_WARNING="warning";e.STATUS_ERROR="error";e.STATUS_OK="ok";e.prototype.constructor=e;e.prototype._setup=function(){var a=this;this.$toolbarPanels.click(function(b){var c=f(this),d=f("#web-debug-panel-"+c.data("panel"));d.length&&(a.$toolbarPanels.removeClass("active"),
d.is(":visible")?a.$panels.hide():(a.$panels.hide(),c.addClass("active"),d.show()),b.preventDefault())});this.$toolbarTogglers.click(function(b){b.preventDefault();a.isToolbarClosed()?(a.openToolbar(),e.Storage.remove("closed")):(a.closeToolbar(),e.Storage.set("closed",!0))})};e.prototype._setupDataFilters=function(){this.$panels.find("input.data-filter").keyup(function(a){a=f(this).parents("table:first");var b=r(a.data("selectiveFilter")||[],"__contains__",this.value);a.data("selectiveFilter",b);
a.children("tbody").children("tr").hide().filter(function(a,d){return s(d,b)}).show()});this.$panels.find("a.data-filter").click(function(a){var b=f(this),c=b.data("filter");if(c){var d=f("#"+c.target);if(d.length){b.parents("ul:first").find("a.data-filter").removeClass("active");b.addClass("active");var b=d.children("tbody").children("tr"),e=r(d.data("selectiveFilter")||[],c.attribute,c.value);d.data("selectiveFilter",e);b.hide().filter(function(a,b){return s(b,e)}).show();a.preventDefault()}}})};
e.prototype._setupTogglers=function(){this.$panels.find("a.web-debug-toggler,a.web-debug-backtrace-toggler").click(function(a){var b=f(this),c=b.data("target"),c=-1===c.indexOf("#")&&-1===c.indexOf(".")?b.parent().find("."+c+":first"):f(c+":first");c.length&&(c.toggleClass("hidden"),b.toggleClass("active"));a.preventDefault()})};e.prototype.setStatus=function(a){switch(a){case e.STATUS_OK:this.$status.addClass("success");break;case e.STATUS_WARNING:this.$status.addClass("warning");break;case e.STATUS_ERROR:this.$status.addClass("error")}};
e.Util={};e.Util.ucFirst=function(a){return a.charAt(0).toUpperCase()+a.slice(1)};e.Util.escapeHtml=function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")};e.$=f;e.Extensions={};e.Highlighter=t;e.Base64=n;e.Cookie=l;e.Storage=new m("_web_debug");e.Instance=null;m=function(a,b,c,d){this.content=e.Base64.decode(a);this.contentType=b;this.errors=[];this.url="";this.$resultHolder=c;this.$panelInfo=d};m.prototype={constructor:m,
setup:function(a){(this.url=a.options.htmlValidator.url)&&this.makeRequest()},displayResult:function(){0===this.errors.length?this.$panelInfo.html('<span class="success">OK</span>'):(this.$panelInfo.html('<span class="warning">'+this.errors.length+"</span>"),e.Instance&&e.Instance.setStatus(e.STATUS_WARNING));this.$resultHolder.html("");var a=[],b=[];a.push("<table>");if(0===this.errors.length)a.push('<tr><td><h3 class="success">Html is valid.</h3></td></tr>');else{a.push("<thead><tr><td></td><td>Error</td><td>Extract</td></tr></thead>");
for(var c=0,d=this.errors.length;c<d;c++){var f=this.errors[c];a.push("<tr><td>#"+(c+1)+"</td><td><strong>"+f.message+"</strong><br />line: "+f.lastLine+", column:"+f.lastColumn+"</td><td><pre><code>"+e.Util.escapeHtml(f.extract)+"</code></pre></td></tr>");b.push(f.lastLine)}a.push('<tr><td colspan="3"><h2>Source</h2>')}a.push("</td></tr>");a.push("</table>");this.$resultHolder.html(a.join("\n"))},makeRequest:function(){if("undefined"===typeof FormData)this.$panelInfo.html('<span class="">n/a</span>');
else{var a=new FormData;a.append("out","json");a.append("content",this.content);var b=this;f.ajax({url:b.url,data:a,dataType:"json",type:"POST",processData:!1,contentType:!1,success:function(a){for(var d=[],e=0,f=a.messages.length;e<f;e++){var g=a.messages[e];if("error"===g.type){if(-1!==g.message.indexOf("X-Ua-Compatible"))continue;d.push(g)}b.errors=d}b.displayResult()},error:function(){b.$panelInfo.html('<span class="warning">Error</span>')}})}}};e.HtmlValidator=m;k.WebDebug=e})(window.jQuery,
window);
